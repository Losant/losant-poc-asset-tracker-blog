{"globals":[],"triggers":[{"config":{},"outputIds":[["rymsd5V1G","Bkgms_5E1z","ryJ7foVyf"]],"key":"DeviceRecipe/Asset","type":"deviceTag","meta":{"category":"trigger","name":"deviceIdsTags","label":"Device: State","x":420,"y":140,"uiId":"ryH7i_qN1z","description":""}}],"nodes":[{"type":"DebugNode","meta":{"category":"output","name":"debug","label":"Debug","x":760,"y":300,"description":""},"config":{"message":"","property":""},"id":"rymsd5V1G","outputIds":[]},{"type":"LatchNode","meta":{"category":"logic","name":"latch","label":"Outside Geofence?","x":480,"y":300,"description":""},"config":{"latchExpression":"{{ data.isOutsideGeofence }} === true","resetExpression":"({{ data.isOutsideGeofence }} !== undefined) && ({{ data.isOutsideGeofence }} === false)","latchResultPath":"","resetResultPath":"","wasLatchedPath":"","isLatchedPath":"","branchPath":"","latchIdTemplate":"isTooDry{{deviceName}}"},"id":"Bkgms_5E1z","outputIds":[[],["HyW7o_qNkG"]]},{"type":"MutateNode","meta":{"category":"logic","name":"mutate","label":"Mutate","x":480,"y":420,"description":""},"config":{"rules":[{"type":"set","destination":"data.emailSubject","valueTemplate":"{{deviceName}}: Outside Geofence"},{"type":"set","destination":"data.emailBody","valueTemplate":"{{deviceName}} is {{ format data.milesFromCenter 'd' }} mi. away. It should be within {{ globals.GEOFENCE_LIMIT_MILES }} mi. of {{ globals.GEOFENCE_CENTER }}."},{"type":"set","destination":"data.smsBody","valueTemplate":"Outside Geofence. {{deviceName}} is {{ format data.milesFromCenter 'd' }} mi. away. It should be within {{ globals.GEOFENCE_LIMIT_MILES }} mi. of {{ globals.GEOFENCE_CENTER }}."}]},"id":"HyW7o_qNkG","outputIds":[["HkMQiu5NJz"]]},{"type":"WorkflowTriggerNode","meta":{"category":"output","name":"workflow-trigger","label":"Email Alerts","x":280,"y":720,"description":""},"config":{"triggerWorkflowId":"5a0717e558025a00072bdc50","triggerVirtualButtonId":"HkeOgu5VJf","payloadTemplate":"data","payloadTemplateType":"path"},"id":"Hy7XjOq4kf","outputIds":[]},{"type":"WorkflowTriggerNode","meta":{"category":"output","name":"workflow-trigger","label":"SMS Alerts","x":500,"y":720,"description":""},"config":{"triggerWorkflowId":"5a0717fe2f3b7d0006343a2f","triggerVirtualButtonId":"SJglzu5EJz","payloadTemplate":"data","payloadTemplateType":"path"},"id":"HJN7j_9VJf","outputIds":[]},{"type":"DebugNode","meta":{"category":"output","name":"debug","label":"Debug","x":380,"y":600,"description":""},"config":{"message":"","property":""},"id":"HkMQiu5NJz","outputIds":[["HJN7j_9VJf","Hy7XjOq4kf"]]},{"type":"LatchNode","meta":{"category":"logic","name":"latch","label":"Is OK again","x":240,"y":300,"description":""},"config":{"latchExpression":"({{ data.isOutsideGeofence }} !== undefined) && ({{ data.isOutsideGeofence }} === false)","resetExpression":"{{ data.isOutsideGeofence }} === true","latchResultPath":"","resetResultPath":"","wasLatchedPath":"","isLatchedPath":"","branchPath":"","latchIdTemplate":"isOK{{deviceName}}"},"id":"ryJ7foVyf","outputIds":[[],["H1D8Ms4yz"]]},{"type":"MutateNode","meta":{"category":"logic","name":"mutate","label":"Mutate","x":260,"y":420,"description":""},"config":{"rules":[{"type":"set","destination":"data.emailSubject","valueTemplate":"{{deviceName}}: Inside Geofence"},{"type":"set","destination":"data.emailBody","valueTemplate":"{{deviceName}} is {{ format data.milesFromCenter 'd' }} mi. away. It is within {{ globals.GEOFENCE_LIMIT_MILES }} mi. of {{ globals.GEOFENCE_CENTER }}."},{"type":"set","destination":"data.smsBody","valueTemplate":"Inside Geofence. {{deviceName}} is {{ format data.milesFromCenter 'd' }} mi. away. It is within {{ globals.GEOFENCE_LIMIT_MILES }} mi. of {{ globals.GEOFENCE_CENTER }}."}]},"id":"H1D8Ms4yz","outputIds":[["HkMQiu5NJz"]]}],"name":"Geofence Alert","enabled":true,"description":"","applicationId":"59b839de38c9e000072e5855","_type":"flow","_exportDate":"2018-01-30T14:25:29.838Z"}